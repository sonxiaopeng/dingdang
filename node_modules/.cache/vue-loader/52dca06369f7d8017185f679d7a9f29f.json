{"remainingRequest":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\uid\\Desktop\\Dr.Dingdang\\src\\views\\mine\\Setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\src\\views\\mine\\Setting.vue","mtime":1611198176000},{"path":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353156000},{"path":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\node_modules\\babel-loader\\lib\\index.js","mtime":1610353156000},{"path":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353156000},{"path":"C:\\Users\\uid\\Desktop\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js","mtime":1610353180000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwTXV0YXRpb25zIH0gZnJvbSAidnVleCI7DQppbXBvcnQgVG9hc3QgZnJvbSAidmFudCI7DQppbXBvcnQgQ3JvcHBlciBmcm9tICJjcm9wcGVyanMiOw0KZXhwb3J0IGRlZmF1bHQgew0KCWRhdGEoKSB7DQoJCXJldHVybiB7DQoJCQlpbWdTcmM6IGBodHRwOi8vMTI3LjAuMC4xOjMwMDAvZGVmYXVsdC1hdmF0YXIucG5nYCwNCgkJCWlzU2hvdzogZmFsc2UsDQoJCQlmdWxsU2NyZWVuSDogIiIsDQoJCQlhdXRvY2hlY2tlZDogdHJ1ZSwNCiAgICAgICAgICAgIG1zZ2NoZWNrZWQ6IGZhbHNlLA0KICAgICAgICAgICAgbWFza0hlaWdodDogJycNCgkJfTsNCgl9LA0KCW1ldGhvZHM6IHsNCgkJYWZ0ZXJSZWFkKGZpbGUpIHsNCgkJCXRoaXMuaXNTaG93ID0gdHJ1ZTsNCgkJCXRoaXMuaW1nU3JjID0gZmlsZS5jb250ZW50Ow0KCQkJbGV0IHBjID0gbmV3IFBob3RvQ2xpcCgiI2NsaXBBcmVhIiwgew0KCQkJCXNpemU6IFsyNjAsIDI2MF0sDQoJCQkJb3V0cHV0U2l6ZTogNjQwLA0KCQkJCS8vYWRhcHRpdmU6IFsnNjAlJywgJzgwJSddLA0KCQkJCS8vIGZpbGU6ICcjZmlsZScsDQoJCQkJLy8gdmlldzogJyN2aWV3JywNCgkJCQlvazogIiNjbGlwQnRuIiwNCgkJCQkvL2ltZzogJ2ltZy9tbS5qcGcnLA0KCQkJCS8vIGxvYWRTdGFydDogZnVuY3Rpb24oKSB7DQoJCQkJLy8gCWNvbnNvbGUubG9nKCLlvIDlp4vor7vlj5bnhafniYciKTsNCgkJCQkvLyB9LA0KCQkJCS8vIGxvYWRDb21wbGV0ZTogZnVuY3Rpb24oKSB7DQoJCQkJLy8gCWNvbnNvbGUubG9nKCLnhafniYfor7vlj5blrozmiJAiKTsNCgkJCQkvLyB9LA0KCQkJCWRvbmU6IGRhdGFVUkwgPT4gew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmltZ1NyYyA9IGRhdGFVUkw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpOw0KCQkJCX0sDQoJCQkJZmFpbDogZnVuY3Rpb24obXNnKSB7DQoJCQkJCS8vIGFsZXJ0KG1zZyk7DQoJCQkJfSwNCgkJCX0pOw0KDQoJCQkvLyDliqDovb3nmoTlm77niYflv4XpobvopoHkuI7mnKznqIvluo/lkIzmupDvvIzlkKbliJnml6Dms5XmiKrlm74NCgkJCXBjLmxvYWQoZmlsZS5jb250ZW50KTsNCgkJfSwNCgkJc2F2ZSgpIHsNCgkJCWxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KCQkJbGV0IGJ5dGVTdHJpbmcgPSBhdG9iKA0KCQkJCXRoaXMuaW1nU3JjLnJlcGxhY2UoL15kYXRhOmltYWdlXC9cdys7YmFzZTY0LC8sICIiKQ0KCQkJKTsNCgkJCWxldCBtaW1lU3RyaW5nID0gdGhpcy5pbWdTcmMNCgkJCQkuc3BsaXQoIiwiKVswXQ0KCQkJCS5zcGxpdCgiOiIpWzFdDQoJCQkJLnNwbGl0KCI7IilbMF07DQoJCQlsZXQgYWIgPSBuZXcgQXJyYXlCdWZmZXIoYnl0ZVN0cmluZy5sZW5ndGgpOw0KCQkJbGV0IGlhID0gbmV3IFVpbnQ4QXJyYXkoYWIpOw0KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlU3RyaW5nLmxlbmd0aDsgaSsrKSB7DQoJCQkJaWFbaV0gPSBieXRlU3RyaW5nLmNoYXJDb2RlQXQoaSk7DQoJCQl9DQoJCQlsZXQgYmxvYiA9IG5ldyBCbG9iKFtpYV0sIHsgdHlwZTogbWltZVN0cmluZyB9KTsNCgkJCWZvcm1EYXRhLmFwcGVuZCgidXBsb2FkRmlsZSIsIGJsb2IsIERhdGUubm93KCkgKyAiLmpwZyIpOw0KCQkJZm9ybURhdGEuYXBwZW5kKCJ1c2VyaWQiLCB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby51c2VyX2lkKTsNCgkJCXRoaXMuYXhpb3MucG9zdCgiL21pbmUvbW9kaWZ5YXZhdGFyIiwgZm9ybURhdGEpLnRoZW4ocmVzID0+IHsNCgkJCQlpZiAocmVzLmRhdGEuY29kZSA9PSAwKSB7DQoJCQkJCWxldCB1c2VySW5mbyA9IEpTT04ucGFyc2UoDQoJCQkJCQlkZWNvZGVVUkkobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpDQoJCQkJCSk7DQoJCQkJCXVzZXJJbmZvLmF2YXRhciA9IHJlcy5kYXRhLmRhdGE7DQoJCQkJCWxvY2FsU3RvcmFnZS5zZXRJdGVtKA0KCQkJCQkJInVzZXJJbmZvIiwNCgkJCQkJCWVuY29kZVVSSShKU09OLnN0cmluZ2lmeSh1c2VySW5mbykpDQoJCQkJCSk7DQoJCQkJCXRoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRlVXNlckluZm8iLCB1c2VySW5mbyk7DQoJCQkJCXRoaXMuJHJvdXRlci5wdXNoKCIvbWluZSIpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCVRvYXN0KHJlcy5kYXRhLm1lc3NhZ2UpOw0KCQkJCX0NCgkJCX0pOw0KCQl9LA0KCQljYW5jZWwoKSB7DQoJCQl0aGlzLmlzU2hvdyA9IGZhbHNlOw0KCQl9LA0KCQlvbk92ZXJzaXplKCkgew0KCQkJVG9hc3QoIuaWh+S7tuWkp+Wwj+S4jeiDvei2hei/hzEwTSIpOw0KCQl9LA0KCQlnb1RvVXBsb2FkKCkgew0KCQkJLy8gdGhpcy4kcm91dGVyLnB1c2goJy9zZXR0aW5nL3VwbG9hZGF2YXRhcicpDQoJCQl0aGlzLiRyZWZzLnVwbG9hZGVyLmNob29zZUZpbGUoKTsNCgkJfSwNCgkJZ29Ub01vZGlmeSgpIHsNCgkJCXRoaXMuJHJvdXRlci5wdXNoKCIvc2V0dGluZy9tb2RpZnluaWNrbmFtZSIpOw0KCQl9LA0KCQlvbkNsaWNrTGVmdCgpIHsNCgkJCXRoaXMuJHJvdXRlci5iYWNrKC0xKTsNCgkJfSwNCgkJcXVpdCgpIHsNCgkJCWxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VySW5mbyIpOw0KCQkJdGhpcy5kZWxldGVVc2VySW5mbygpOw0KCQkJdGhpcy4kcm91dGVyLnB1c2goIi9taW5lIik7DQoJCX0sDQoJCS4uLm1hcE11dGF0aW9ucyhbImRlbGV0ZVVzZXJJbmZvIl0pLA0KCX0sDQoJY29tcHV0ZWQ6IHsNCgkJLi4ubWFwU3RhdGUoWyJ1c2VySW5mbyJdKSwNCgl9LA0KCW1vdW50ZWQoKSB7DQoJCXRoaXMuZnVsbFNjcmVlbkggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgInB4IjsNCgkJdGhpcy5tYXNrSGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoICsgInB4IjsNCiAgICAgICAgfSwNCn07DQo="},{"version":3,"sources":["Setting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Setting.vue","sourceRoot":"src/views/mine","sourcesContent":["<template>\r\n\t<div id=\"setting\">\r\n\t\t<van-nav-bar title=\"设置\" left-arrow @click-left=\"onClickLeft\" />\r\n\t\t<van-cell title=\"头像\" size=\"large\" @click=\"goToUpload\">\r\n\t\t\t<van-image\r\n\t\t\t\tround\r\n\t\t\t\twidth=\"50px\"\r\n\t\t\t\theight=\"50px\"\r\n\t\t\t\t:src=\"`http://127.0.0.1:3000/${userInfo.avatar}`\"\r\n\t\t\t/>\r\n\t\t</van-cell>\r\n\t\t<van-cell\r\n\t\t\t@click=\"goToModify\"\r\n\t\t\ttitle=\"昵称\"\r\n\t\t\t:value=\"userInfo.nickname\"\r\n\t\t\tsize=\"large\"\r\n\t\t/>\r\n\t\t<van-cell title=\"账号管理\" size=\"large\" />\r\n\t\t<van-cell title=\"自动草稿\" size=\"large\">\r\n\t\t\t<van-switch v-model=\"autochecked\" active-color=\"#00c792\" />\r\n\t\t</van-cell>\r\n\t\t<van-cell title=\"消息通知\" size=\"large\">\r\n\t\t\t<van-switch v-model=\"msgchecked\" active-color=\"#00c792\" />\r\n\t\t</van-cell>\r\n\t\t<van-cell title=\"隐私设置\" size=\"large\" />\r\n\t\t<van-cell title=\"清理缓存\" value=\"8.7M\" size=\"large\" />\r\n\t\t<van-cell title=\"去好评\" size=\"large\" />\r\n\t\t<van-cell title=\"推荐给朋友\" size=\"large\" />\r\n\t\t<van-cell title=\"关于我们\" size=\"large\" />\r\n\t\t<van-button\r\n\t\t\tclass=\"quit-btn\"\r\n\t\t\ttype=\"danger\"\r\n\t\t\tplain\r\n\t\t\tsize=\"large\"\r\n\t\t\t@click=\"quit\"\r\n\t\t\t>退出登录</van-button\r\n\t\t>\r\n\t\t<van-uploader\r\n\t\t\t:after-read=\"afterRead\"\r\n\t\t\tref=\"uploader\"\r\n\t\t\t:max-size=\"10 * 1024 * 1024\"\r\n\t\t\t@oversize=\"onOversize\"\r\n\t\t>\r\n\t\t\t<div style=\"display: none\"></div>\r\n\t\t</van-uploader>\r\n\t\t<div\r\n\t\t\tclass=\"img-container\"\r\n\t\t\t:style=\"{ height: fullScreenH }\"\r\n\t\t\tv-show=\"isShow\"\r\n\t\t>\r\n\t\t\t<!-- <img ref=\"image\" :src=\"imgSrc\" /> -->\r\n\t\t\t<div id=\"clipArea\" :style=\"{height: maskHeight}\"></div>\r\n\t\t\t<div class=\"btn left\" @click=\"cancel\">取消</div>\r\n\t\t\t<div id=\"clipBtn\" class=\"btn right\">保存</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport { mapState, mapMutations } from \"vuex\";\r\nimport Toast from \"vant\";\r\nimport Cropper from \"cropperjs\";\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\timgSrc: `http://127.0.0.1:3000/default-avatar.png`,\r\n\t\t\tisShow: false,\r\n\t\t\tfullScreenH: \"\",\r\n\t\t\tautochecked: true,\r\n            msgchecked: false,\r\n            maskHeight: ''\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\tafterRead(file) {\r\n\t\t\tthis.isShow = true;\r\n\t\t\tthis.imgSrc = file.content;\r\n\t\t\tlet pc = new PhotoClip(\"#clipArea\", {\r\n\t\t\t\tsize: [260, 260],\r\n\t\t\t\toutputSize: 640,\r\n\t\t\t\t//adaptive: ['60%', '80%'],\r\n\t\t\t\t// file: '#file',\r\n\t\t\t\t// view: '#view',\r\n\t\t\t\tok: \"#clipBtn\",\r\n\t\t\t\t//img: 'img/mm.jpg',\r\n\t\t\t\t// loadStart: function() {\r\n\t\t\t\t// \tconsole.log(\"开始读取照片\");\r\n\t\t\t\t// },\r\n\t\t\t\t// loadComplete: function() {\r\n\t\t\t\t// \tconsole.log(\"照片读取完成\");\r\n\t\t\t\t// },\r\n\t\t\t\tdone: dataURL => {\r\n                    this.imgSrc = dataURL;\r\n                    this.save();\r\n\t\t\t\t},\r\n\t\t\t\tfail: function(msg) {\r\n\t\t\t\t\t// alert(msg);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\t// 加载的图片必须要与本程序同源，否则无法截图\r\n\t\t\tpc.load(file.content);\r\n\t\t},\r\n\t\tsave() {\r\n\t\t\tlet formData = new FormData();\r\n\t\t\tlet byteString = atob(\r\n\t\t\t\tthis.imgSrc.replace(/^data:image\\/\\w+;base64,/, \"\")\r\n\t\t\t);\r\n\t\t\tlet mimeString = this.imgSrc\r\n\t\t\t\t.split(\",\")[0]\r\n\t\t\t\t.split(\":\")[1]\r\n\t\t\t\t.split(\";\")[0];\r\n\t\t\tlet ab = new ArrayBuffer(byteString.length);\r\n\t\t\tlet ia = new Uint8Array(ab);\r\n\t\t\tfor (var i = 0; i < byteString.length; i++) {\r\n\t\t\t\tia[i] = byteString.charCodeAt(i);\r\n\t\t\t}\r\n\t\t\tlet blob = new Blob([ia], { type: mimeString });\r\n\t\t\tformData.append(\"uploadFile\", blob, Date.now() + \".jpg\");\r\n\t\t\tformData.append(\"userid\", this.$store.state.userInfo.user_id);\r\n\t\t\tthis.axios.post(\"/mine/modifyavatar\", formData).then(res => {\r\n\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\tlet userInfo = JSON.parse(\r\n\t\t\t\t\t\tdecodeURI(localStorage.getItem(\"userInfo\"))\r\n\t\t\t\t\t);\r\n\t\t\t\t\tuserInfo.avatar = res.data.data;\r\n\t\t\t\t\tlocalStorage.setItem(\r\n\t\t\t\t\t\t\"userInfo\",\r\n\t\t\t\t\t\tencodeURI(JSON.stringify(userInfo))\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.$store.commit(\"updateUserInfo\", userInfo);\r\n\t\t\t\t\tthis.$router.push(\"/mine\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tToast(res.data.message);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tcancel() {\r\n\t\t\tthis.isShow = false;\r\n\t\t},\r\n\t\tonOversize() {\r\n\t\t\tToast(\"文件大小不能超过10M\");\r\n\t\t},\r\n\t\tgoToUpload() {\r\n\t\t\t// this.$router.push('/setting/uploadavatar')\r\n\t\t\tthis.$refs.uploader.chooseFile();\r\n\t\t},\r\n\t\tgoToModify() {\r\n\t\t\tthis.$router.push(\"/setting/modifynickname\");\r\n\t\t},\r\n\t\tonClickLeft() {\r\n\t\t\tthis.$router.back(-1);\r\n\t\t},\r\n\t\tquit() {\r\n\t\t\tlocalStorage.removeItem(\"userInfo\");\r\n\t\t\tthis.deleteUserInfo();\r\n\t\t\tthis.$router.push(\"/mine\");\r\n\t\t},\r\n\t\t...mapMutations([\"deleteUserInfo\"]),\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"userInfo\"]),\r\n\t},\r\n\tmounted() {\r\n\t\tthis.fullScreenH = document.documentElement.clientHeight + \"px\";\r\n\t\tthis.maskHeight = document.documentElement.clientWidth + \"px\";\r\n        },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#setting .img-container > .btn.right {\r\n\tright: 0;\r\n}\r\n\r\n#setting .img-container > .btn.left {\r\n\tleft: 0;\r\n}\r\n\r\n#setting .img-container > .btn {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tpadding: 20px;\r\n\tcolor: #fff;\r\n\tfont-size: 16px;\r\n}\r\n\r\n#setting .img-container > #clipArea,\r\n#setting .img-container > img {\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n#setting .img-container {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tz-index: 100;\r\n\twidth: 100%;\r\n\tbackground-color: #000;\r\n}\r\n\r\n#setting .van-cell {\r\n\talign-items: center;\r\n}\r\n\r\n.quit-btn {\r\n\tborder: 0;\r\n\t/* margin-top: 50px; */\r\n}\r\n</style>\r\n"]}]}