{"remainingRequest":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\src\\views\\mine\\Setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\src\\views\\mine\\Setting.vue","mtime":1611145556883},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353155479},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\babel-loader\\lib\\index.js","mtime":1610353154995},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353155479},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js","mtime":1610353179708}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwTXV0YXRpb25zIH0gZnJvbSAidnVleCI7DQppbXBvcnQgVG9hc3QgZnJvbSAidmFudCI7DQppbXBvcnQgQ3JvcHBlciBmcm9tICJjcm9wcGVyanMiOw0KZXhwb3J0IGRlZmF1bHQgew0KCWRhdGEoKSB7DQoJCXJldHVybiB7DQoJCQlpbWdTcmM6IGBodHRwOi8vMTI3LjAuMC4xOjMwMDAvZGVmYXVsdC1hdmF0YXIucG5nYCwNCgkJCWlzU2hvdzogZmFsc2UsDQoJCQlmdWxsU2NyZWVuSDogIiIsDQoJCQlhdXRvY2hlY2tlZDogdHJ1ZSwNCgkJCW1zZ2NoZWNrZWQ6IGZhbHNlLA0KCQl9Ow0KCX0sDQoJbWV0aG9kczogew0KCQlhZnRlclJlYWQoZmlsZSkgew0KCQkJdGhpcy5pc1Nob3cgPSB0cnVlOw0KCQkJLy8gY29uc3QgaW1hZ2UgPSB0aGlzLiRyZWZzLmltYWdlOw0KICAgICAgICAgICAgLy8gaW1hZ2Uuc3JjID0gZmlsZS5jb250ZW50Ow0KICAgICAgICAgICAgdGhpcy5pbWdTcmMgPSBmaWxlLmNvbnRlbnQNCgkJCS8vIGNvbnN0IGNyb3BwZXIgPSBuZXcgQ3JvcHBlcihpbWFnZSwgew0KCQkJLy8gCWFzcGVjdFJhdGlvOiAxLA0KCQkJLy8gCXZpZXdNb2RlOiAxLA0KCQkJLy8gCWJhY2tncm91bmQ6IGZhbHNlLA0KCQkJLy8gCWNyb3AoZXZlbnQpIHsNCgkJCS8vIAkJY29uc29sZS5sb2coZXZlbnQuZGV0YWlsLngpOw0KCQkJLy8gCQljb25zb2xlLmxvZyhldmVudC5kZXRhaWwueSk7DQoJCQkvLyAJCWNvbnNvbGUubG9nKGV2ZW50LmRldGFpbC53aWR0aCk7DQoJCQkvLyAJCWNvbnNvbGUubG9nKGV2ZW50LmRldGFpbC5oZWlnaHQpOw0KCQkJLy8gCQljb25zb2xlLmxvZyhldmVudC5kZXRhaWwucm90YXRlKTsNCgkJCS8vIAkJY29uc29sZS5sb2coZXZlbnQuZGV0YWlsLnNjYWxlWCk7DQoJCQkvLyAJCWNvbnNvbGUubG9nKGV2ZW50LmRldGFpbC5zY2FsZVkpOw0KCQkJLy8gCX0sDQoJCQkvLyB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgc2F2ZSgpew0KICAgICAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7DQogICAgICAgICAgICBsZXQgYnl0ZVN0cmluZyA9IGF0b2IoDQogICAgICAgICAgICAgICAgdGhpcy5pbWdTcmMucmVwbGFjZSgvXmRhdGE6aW1hZ2VcL1x3KztiYXNlNjQsLywgIiIpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgbGV0IG1pbWVTdHJpbmcgPSB0aGlzLmltZ1NyYw0KICAgICAgICAgICAgICAgIC5zcGxpdCgiLCIpWzBdDQogICAgICAgICAgICAgICAgLnNwbGl0KCI6IilbMV0NCiAgICAgICAgICAgICAgICAuc3BsaXQoIjsiKVswXTsNCiAgICAgICAgICAgIGxldCBhYiA9IG5ldyBBcnJheUJ1ZmZlcihieXRlU3RyaW5nLmxlbmd0aCk7DQogICAgICAgICAgICBsZXQgaWEgPSBuZXcgVWludDhBcnJheShhYik7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVTdHJpbmcubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpYVtpXSA9IGJ5dGVTdHJpbmcuY2hhckNvZGVBdChpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGxldCBibG9iID0gbmV3IEJsb2IoW2lhXSwgeyB0eXBlOiBtaW1lU3RyaW5nIH0pOw0KICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJ1cGxvYWRGaWxlIiwgYmxvYiwgRGF0ZS5ub3coKSArICIuanBnIik7DQogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoInVzZXJpZCIsIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJfaWQpOw0KICAgICAgICAgICAgdGhpcy5heGlvcy5wb3N0KCcvbWluZS9tb2RpZnlhdmF0YXInLCBmb3JtRGF0YSkNCiAgICAgICAgICAgIC50aGVuKHJlcz0+ew0KICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJJbmZvID0gSlNPTi5wYXJzZShkZWNvZGVVUkkobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJbmZvJykpKQ0KICAgICAgICAgICAgICAgICAgICB1c2VySW5mby5hdmF0YXIgPSByZXMuZGF0YS5kYXRhDQogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VySW5mbycsIGVuY29kZVVSSShKU09OLnN0cmluZ2lmeSh1c2VySW5mbykpKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VwZGF0ZVVzZXJJbmZvJywgdXNlckluZm8pDQoJCQkJCXRoaXMuJHJvdXRlci5wdXNoKCIvc2V0dGluZyIpOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJVG9hc3QocmVzLmRhdGEubWVzc2FnZSk7DQoJCQkJCX0NCiAgICAgICAgICAgIH0pDQoNCg0KICAgICAgICB9LA0KICAgICAgICBjYW5jZWwoKXsNCiAgICAgICAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2U7DQogICAgICAgIH0sDQoJCW9uT3ZlcnNpemUoKSB7DQoJCQlUb2FzdCgi5paH5Lu25aSn5bCP5LiN6IO96LaF6L+HMTBNIik7DQoJCX0sDQoJCWdvVG9VcGxvYWQoKSB7DQoJCQkvLyB0aGlzLiRyb3V0ZXIucHVzaCgnL3NldHRpbmcvdXBsb2FkYXZhdGFyJykNCgkJCXRoaXMuJHJlZnMudXBsb2FkZXIuY2hvb3NlRmlsZSgpOw0KCQl9LA0KCQlnb1RvTW9kaWZ5KCkgew0KCQkJdGhpcy4kcm91dGVyLnB1c2goIi9zZXR0aW5nL21vZGlmeW5pY2tuYW1lIik7DQoJCX0sDQoJCW9uQ2xpY2tMZWZ0KCkgew0KCQkJdGhpcy4kcm91dGVyLmJhY2soLTEpOw0KCQl9LA0KCQlxdWl0KCkgew0KCQkJbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oInVzZXJJbmZvIik7DQoJCQl0aGlzLmRlbGV0ZVVzZXJJbmZvKCk7DQoJCQl0aGlzLiRyb3V0ZXIucHVzaCgiL21pbmUiKTsNCgkJfSwNCgkJLi4ubWFwTXV0YXRpb25zKFsiZGVsZXRlVXNlckluZm8iXSksDQoJfSwNCgljb21wdXRlZDogew0KCQkuLi5tYXBTdGF0ZShbInVzZXJJbmZvIl0pLA0KCX0sDQoJbW91bnRlZCgpIHsNCgkJdGhpcy5mdWxsU2NyZWVuSCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKyAicHgiOw0KCX0sDQp9Ow0K"},{"version":3,"sources":["Setting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Setting.vue","sourceRoot":"src/views/mine","sourcesContent":["<template>\r\n\t<div id=\"setting\">\r\n\t\t<van-nav-bar title=\"设置\" left-arrow @click-left=\"onClickLeft\" />\r\n\t\t<van-cell title=\"头像\" size=\"large\" @click=\"goToUpload\">\r\n\t\t\t<van-image\r\n\t\t\t\tround\r\n\t\t\t\twidth=\"50px\"\r\n\t\t\t\theight=\"50px\"\r\n\t\t\t\t:src=\"`http://127.0.0.1:3000/${userInfo.avatar}`\"\r\n\t\t\t/>\r\n\t\t</van-cell>\r\n\t\t<van-cell\r\n\t\t\t@click=\"goToModify\"\r\n\t\t\ttitle=\"昵称\"\r\n\t\t\t:value=\"userInfo.nickname\"\r\n\t\t\tsize=\"large\"\r\n\t\t/>\r\n\t\t<van-cell title=\"账号管理\" size=\"large\" />\r\n\t\t<van-cell title=\"自动草稿\" size=\"large\">\r\n\t\t\t<van-switch v-model=\"autochecked\" active-color=\"#00c792\" />\r\n\t\t</van-cell>\r\n\t\t<van-cell title=\"消息通知\" size=\"large\">\r\n\t\t\t<van-switch v-model=\"msgchecked\" active-color=\"#00c792\" />\r\n\t\t</van-cell>\r\n\t\t<van-cell title=\"隐私设置\" size=\"large\" />\r\n\t\t<van-cell title=\"清理缓存\" value=\"8.7M\" size=\"large\" />\r\n\t\t<van-cell title=\"去好评\" size=\"large\" />\r\n\t\t<van-cell title=\"推荐给朋友\" size=\"large\" />\r\n\t\t<van-cell title=\"关于我们\" size=\"large\" />\r\n\t\t<van-button\r\n\t\t\tclass=\"quit-btn\"\r\n\t\t\ttype=\"danger\"\r\n\t\t\tplain\r\n\t\t\tsize=\"large\"\r\n\t\t\t@click=\"quit\"\r\n\t\t\t>退出登录</van-button\r\n\t\t>\r\n\t\t<van-uploader\r\n\t\t\t:after-read=\"afterRead\"\r\n\t\t\tref=\"uploader\"\r\n\t\t\t:max-size=\"10 * 1024 * 1024\"\r\n\t\t\t@oversize=\"onOversize\"\r\n\t\t>\r\n\t\t\t<div style=\"display: none\"></div>\r\n\t\t</van-uploader>\r\n\t\t<div\r\n\t\t\tclass=\"img-container\"\r\n\t\t\t:style=\"{ height: fullScreenH }\"\r\n\t\t\tv-show=\"isShow\"\r\n\t\t>\r\n\t\t\t<img ref=\"image\" :src=\"imgSrc\" />\r\n            <div class=\"btn left\" @click=\"cancel\">取消</div>\r\n            <div class=\"btn right\" @click=\"save\">保存</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport { mapState, mapMutations } from \"vuex\";\r\nimport Toast from \"vant\";\r\nimport Cropper from \"cropperjs\";\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\timgSrc: `http://127.0.0.1:3000/default-avatar.png`,\r\n\t\t\tisShow: false,\r\n\t\t\tfullScreenH: \"\",\r\n\t\t\tautochecked: true,\r\n\t\t\tmsgchecked: false,\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\tafterRead(file) {\r\n\t\t\tthis.isShow = true;\r\n\t\t\t// const image = this.$refs.image;\r\n            // image.src = file.content;\r\n            this.imgSrc = file.content\r\n\t\t\t// const cropper = new Cropper(image, {\r\n\t\t\t// \taspectRatio: 1,\r\n\t\t\t// \tviewMode: 1,\r\n\t\t\t// \tbackground: false,\r\n\t\t\t// \tcrop(event) {\r\n\t\t\t// \t\tconsole.log(event.detail.x);\r\n\t\t\t// \t\tconsole.log(event.detail.y);\r\n\t\t\t// \t\tconsole.log(event.detail.width);\r\n\t\t\t// \t\tconsole.log(event.detail.height);\r\n\t\t\t// \t\tconsole.log(event.detail.rotate);\r\n\t\t\t// \t\tconsole.log(event.detail.scaleX);\r\n\t\t\t// \t\tconsole.log(event.detail.scaleY);\r\n\t\t\t// \t},\r\n\t\t\t// });\r\n        },\r\n        save(){\r\n            let formData = new FormData();\r\n            let byteString = atob(\r\n                this.imgSrc.replace(/^data:image\\/\\w+;base64,/, \"\")\r\n            );\r\n            let mimeString = this.imgSrc\r\n                .split(\",\")[0]\r\n                .split(\":\")[1]\r\n                .split(\";\")[0];\r\n            let ab = new ArrayBuffer(byteString.length);\r\n            let ia = new Uint8Array(ab);\r\n            for (var i = 0; i < byteString.length; i++) {\r\n                ia[i] = byteString.charCodeAt(i);\r\n            }\r\n            let blob = new Blob([ia], { type: mimeString });\r\n            formData.append(\"uploadFile\", blob, Date.now() + \".jpg\");\r\n            formData.append(\"userid\", this.$store.state.userInfo.user_id);\r\n            this.axios.post('/mine/modifyavatar', formData)\r\n            .then(res=>{\r\n                if (res.data.code == 0) {\r\n                    let userInfo = JSON.parse(decodeURI(localStorage.getItem('userInfo')))\r\n                    userInfo.avatar = res.data.data\r\n                    localStorage.setItem('userInfo', encodeURI(JSON.stringify(userInfo)))\r\n                    this.$store.commit('updateUserInfo', userInfo)\r\n\t\t\t\t\tthis.$router.push(\"/setting\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tToast(res.data.message);\r\n\t\t\t\t\t}\r\n            })\r\n\r\n\r\n        },\r\n        cancel(){\r\n            this.isShow = false;\r\n        },\r\n\t\tonOversize() {\r\n\t\t\tToast(\"文件大小不能超过10M\");\r\n\t\t},\r\n\t\tgoToUpload() {\r\n\t\t\t// this.$router.push('/setting/uploadavatar')\r\n\t\t\tthis.$refs.uploader.chooseFile();\r\n\t\t},\r\n\t\tgoToModify() {\r\n\t\t\tthis.$router.push(\"/setting/modifynickname\");\r\n\t\t},\r\n\t\tonClickLeft() {\r\n\t\t\tthis.$router.back(-1);\r\n\t\t},\r\n\t\tquit() {\r\n\t\t\tlocalStorage.removeItem(\"userInfo\");\r\n\t\t\tthis.deleteUserInfo();\r\n\t\t\tthis.$router.push(\"/mine\");\r\n\t\t},\r\n\t\t...mapMutations([\"deleteUserInfo\"]),\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"userInfo\"]),\r\n\t},\r\n\tmounted() {\r\n\t\tthis.fullScreenH = document.documentElement.clientHeight + \"px\";\r\n\t},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#setting .img-container > .btn.right {\r\n    right: 0;\r\n}\r\n\r\n#setting .img-container > .btn.left {\r\n    left: 0;\r\n}\r\n\r\n#setting .img-container > .btn {\r\n    position: absolute;\r\n    top: 0;\r\n    padding: 20px;\r\n    color: #fff;\r\n    font-size: 16px;\r\n}\r\n\r\n#setting .img-container > img {\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n#setting .img-container {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tz-index: 100;\r\n\twidth: 100%;\r\n\tbackground-color: #000;\r\n}\r\n\r\n#setting .van-cell {\r\n\talign-items: center;\r\n}\r\n\r\n.quit-btn {\r\n\tborder: 0;\r\n\t/* margin-top: 50px; */\r\n}\r\n</style>\r\n"]}]}