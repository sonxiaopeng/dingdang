{"remainingRequest":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\src\\components\\Clipper.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\src\\components\\Clipper.vue","mtime":1611110444785},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353155479},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\babel-loader\\lib\\index.js","mtime":1610353154995},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1610353155479},{"path":"C:\\Users\\web\\Desktop\\myGit\\Dr.Dingdang\\node_modules\\vue-loader\\lib\\index.js","mtime":1610353179708}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQ3JvcHBlciBmcm9tICJjcm9wcGVyanMiOw0KaW1wb3J0ICJjcm9wcGVyanMvZGlzdC9jcm9wcGVyLm1pbi5jc3MiOw0KZXhwb3J0IGRlZmF1bHQgew0KCW5hbWU6ICJ2LXNpbXBsZS1jcm9wcGVyIiwNCglwcm9wczogew0KCQlpbml0UGFyYW06IE9iamVjdCwNCgkJc3VjY2Vzc0NhbGxiYWNrOiB7DQoJCQl0eXBlOiBGdW5jdGlvbiwNCgkJCWRlZmF1bHQ6ICgpID0+IHt9LA0KCQl9LA0KCX0sDQoJZGF0YSgpIHsNCgkJcmV0dXJuIHsNCgkJCWNyb3BwZXI6IHt9LA0KCQkJZmlsZW5hbWU6ICIiLA0KCQl9Ow0KCX0sDQoJbW91bnRlZCgpIHsNCgkJdGhpcy5pbml0KCk7DQoJfSwNCgltZXRob2RzOiB7DQoJCS8vIOWIneWni+WMluijgeWJquaPkuS7tg0KCQlpbml0KCkgew0KCQkJbGV0IGNyb3BwZXJJbWcgPSB0aGlzLiRyZWZzWyJjcm9wcGVySW1nIl07DQoJCQl0aGlzLmNyb3BwZXIgPSBuZXcgQ3JvcHBlcihjcm9wcGVySW1nLCB7DQoJCQkJYXNwZWN0UmF0aW86IDEgLyAxLA0KCQkJCWRyYWdNb2RlOiAibW92ZSIsDQoJCQl9KTsNCgkJfSwNCgkJLy8g54K55Ye75LiK5Lyg5oyJ6ZKuDQoJCXVwbG9hZCgpIHsNCgkJCXRoaXMuJHJlZnNbImZpbGUiXS5jbGljaygpOw0KCQl9LA0KCQkvLyDpgInmi6nkuIrkvKDmlofku7YNCgkJdXBsb2FkQ2hhbmdlKGUpIHsNCgkJCWxldCBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07DQoJCQl0aGlzLmZpbGVuYW1lID0gZmlsZVsibmFtZSJdOw0KCQkJbGV0IFVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDsNCgkJCXRoaXMuJHJlZnNbImxheWVyIl0uc3R5bGUuZGlzcGxheSA9ICJibG9jayI7DQoJCQl0aGlzLmNyb3BwZXIucmVwbGFjZShVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpKTsNCgkJfSwNCgkJLy8g5Y+W5raI5LiK5LygDQoJCWNhbmNlbEhhbmRsZSgpIHsNCgkJCXRoaXMuY3JvcHBlci5yZXNldCgpOw0KCQkJdGhpcy4kcmVmc1sibGF5ZXIiXS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KCQkJdGhpcy4kcmVmc1siZmlsZSJdLnZhbHVlID0gIiI7DQoJCX0sDQoJCS8vIOehruWumuS4iuS8oA0KCQljb25maXJtSGFuZGxlKCkgew0KCQkJbGV0IGNyb3BCb3ggPSB0aGlzLmNyb3BwZXIuZ2V0Q3JvcEJveERhdGEoKTsNCgkJCWxldCBzY2FsZSA9IHRoaXMuaW5pdFBhcmFtWyJzY2FsZSJdIHx8IDE7DQoJCQlsZXQgY3JvcENhbnZhcyA9IHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkQ2FudmFzKHsNCgkJCQl3aWR0aDogY3JvcEJveC53aWR0aCAqIHNjYWxlLA0KCQkJCWhlaWdodDogY3JvcEJveC5oZWlnaHQgKiBzY2FsZSwNCgkJCX0pOw0KCQkJbGV0IGltZ0RhdGEgPSBjcm9wQ2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvanBlZyIpOw0KCQkJbGV0IGZvcm1EYXRhID0gbmV3IHdpbmRvdy5Gb3JtRGF0YSgpOw0KCQkJZm9ybURhdGEuYXBwZW5kKCJmaWxlVHlwZSIsIHRoaXMuaW5pdFBhcmFtWyJmaWxlVHlwZSJdKTsNCgkJCWZvcm1EYXRhLmFwcGVuZCgiaW1nIiwgaW1nRGF0YSk7DQoJCQlmb3JtRGF0YS5hcHBlbmQoInNpZ25JZCIsIHRoaXMuJGxvY2FsU3RvcmFnZSgic2lnbklkIikpOw0KCQkJZm9ybURhdGEuYXBwZW5kKCJvcmlnaW5hbEZpbGVuYW1lIiwgdGhpcy5maWxlbmFtZSk7DQoJCQl3aW5kb3cNCgkJCQkuJGF4aW9zKHRoaXMuaW5pdFBhcmFtWyJ1cGxvYWRVUkwiXSwgZm9ybURhdGEsIHsNCgkJCQkJbWV0aG9kOiAicG9zdCIsDQoJCQkJCWhlYWRlcnM6IHsgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiB9LA0KCQkJCX0pDQoJCQkJLnRoZW4ocmVzID0+IHsNCgkJCQkJdGhpcy5zdWNjZXNzQ2FsbGJhY2socmVzLmRhdGEpOw0KCQkJCQl0aGlzLmNhbmNlbEhhbmRsZSgpOw0KCQkJCX0pOw0KCQl9LA0KCX0sDQp9Ow0K"},{"version":3,"sources":["Clipper.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Clipper.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<div class=\"v-simple-cropper\">\r\n\t\t<slot>\r\n\t\t\t<button @click=\"upload\">上传图片</button>\r\n\t\t</slot>\r\n\t\t<input\r\n\t\t\tclass=\"file\"\r\n\t\t\tref=\"file\"\r\n\t\t\ttype=\"file\"\r\n\t\t\taccept=\"image/*\"\r\n\t\t\t@change=\"uploadChange\"\r\n\t\t/>\r\n\t\t<div class=\"v-cropper-layer\" ref=\"layer\">\r\n\t\t\t<div class=\"layer-header\">\r\n\t\t\t\t<button class=\"cancel\" @click=\"cancelHandle\">取消</button>\r\n\t\t\t\t<button class=\"confirm\" @click=\"confirmHandle\">裁剪</button>\r\n\t\t\t</div>\r\n\t\t\t<img ref=\"cropperImg\" />\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport Cropper from \"cropperjs\";\r\nimport \"cropperjs/dist/cropper.min.css\";\r\nexport default {\r\n\tname: \"v-simple-cropper\",\r\n\tprops: {\r\n\t\tinitParam: Object,\r\n\t\tsuccessCallback: {\r\n\t\t\ttype: Function,\r\n\t\t\tdefault: () => {},\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcropper: {},\r\n\t\t\tfilename: \"\",\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.init();\r\n\t},\r\n\tmethods: {\r\n\t\t// 初始化裁剪插件\r\n\t\tinit() {\r\n\t\t\tlet cropperImg = this.$refs[\"cropperImg\"];\r\n\t\t\tthis.cropper = new Cropper(cropperImg, {\r\n\t\t\t\taspectRatio: 1 / 1,\r\n\t\t\t\tdragMode: \"move\",\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 点击上传按钮\r\n\t\tupload() {\r\n\t\t\tthis.$refs[\"file\"].click();\r\n\t\t},\r\n\t\t// 选择上传文件\r\n\t\tuploadChange(e) {\r\n\t\t\tlet file = e.target.files[0];\r\n\t\t\tthis.filename = file[\"name\"];\r\n\t\t\tlet URL = window.URL || window.webkitURL;\r\n\t\t\tthis.$refs[\"layer\"].style.display = \"block\";\r\n\t\t\tthis.cropper.replace(URL.createObjectURL(file));\r\n\t\t},\r\n\t\t// 取消上传\r\n\t\tcancelHandle() {\r\n\t\t\tthis.cropper.reset();\r\n\t\t\tthis.$refs[\"layer\"].style.display = \"none\";\r\n\t\t\tthis.$refs[\"file\"].value = \"\";\r\n\t\t},\r\n\t\t// 确定上传\r\n\t\tconfirmHandle() {\r\n\t\t\tlet cropBox = this.cropper.getCropBoxData();\r\n\t\t\tlet scale = this.initParam[\"scale\"] || 1;\r\n\t\t\tlet cropCanvas = this.cropper.getCroppedCanvas({\r\n\t\t\t\twidth: cropBox.width * scale,\r\n\t\t\t\theight: cropBox.height * scale,\r\n\t\t\t});\r\n\t\t\tlet imgData = cropCanvas.toDataURL(\"image/jpeg\");\r\n\t\t\tlet formData = new window.FormData();\r\n\t\t\tformData.append(\"fileType\", this.initParam[\"fileType\"]);\r\n\t\t\tformData.append(\"img\", imgData);\r\n\t\t\tformData.append(\"signId\", this.$localStorage(\"signId\"));\r\n\t\t\tformData.append(\"originalFilename\", this.filename);\r\n\t\t\twindow\r\n\t\t\t\t.$axios(this.initParam[\"uploadURL\"], formData, {\r\n\t\t\t\t\tmethod: \"post\",\r\n\t\t\t\t\theaders: { \"Content-Type\": \"multipart/form-data\" },\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.successCallback(res.data);\r\n\t\t\t\t\tthis.cancelHandle();\r\n\t\t\t\t});\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.v-simple-cropper .file {\r\n\tdisplay: none;\r\n}\r\n.v-simple-cropper .v-cropper-layer {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbackground: #fff;\r\n\tz-index: 99999;\r\n\tdisplay: none;\r\n}\r\n.v-simple-cropper .v-cropper-layer .layer-header {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tz-index: 99999;\r\n\tbackground: #fff;\r\n\twidth: 100%;\r\n\theight: 0.8rem;\r\n\tpadding: 0 0.2rem;\r\n\tbox-sizing: border-box;\r\n}\r\n.v-simple-cropper .v-cropper-layer .cancel,\r\n.v-simple-cropper .v-cropper-layer .confirm {\r\n\tline-height: 0.8rem;\r\n\tfont-size: 0.28rem;\r\n\tbackground: inherit;\r\n\tborder: 0;\r\n\toutline: 0;\r\n\tfloat: left;\r\n}\r\n.v-simple-cropper .v-cropper-layer .confirm {\r\n\tfloat: right;\r\n}\r\n.v-simple-cropper .v-cropper-layer img {\r\n\tposition: inherit !important;\r\n\tborder-radius: inherit !important;\r\n\tfloat: inherit !important;\r\n}\r\n</style>\r\n"]}]}